{
  "entityType" : "WIDGET_TYPE",
  "entity" : {
    "fqn" : "blinking_air_status",
    "name" : "Blinking Air Status",
    "deprecated" : false,
    "image" : null,
    "description" : null,
    "descriptor" : {
      "type" : "latest",
      "sizeX" : 7.5,
      "sizeY" : 3,
      "resources" : [ ],
      "templateHtml" : "<div class=\"myio-widget\">\r\n  <div class=\"myio-image\"><img src=\"...\" /></div>\r\n  <div class=\"myio-status\">Status: ON / OFF</div>\r\n</div>\r\n",
      "templateCss" : "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}",
      "controllerScript" : "self.onInit = function () {\r\n    const s = self.ctx.settings || {};\r\n    const container = self.ctx.$container;\r\n\r\n    // Reset container\r\n    container.empty();\r\n\r\n    // Build HTML\r\n    const html = `\r\n      <div id=\"myio-widget\" style=\"text-align: center; font-family: sans-serif;\">\r\n        <div id=\"myio-title\" style=\"font-size: 18px; margin-bottom: 8px;\">Consumo</div>\r\n        <div id=\"myio-image\" style=\"margin: 10px;\">\r\n          <img id=\"myio-img\" src=\"${s.offImageUrl || 'https://www.tech2w.com/myio/ar-off-model.png'}\" style=\"width: 100px; transition: opacity 0.5s ease-in-out;\" />\r\n        </div>\r\n        <div id=\"myio-status\" style=\"font-size: 16px; color: #666;\">Sem dado</div>\r\n      </div>\r\n    `;\r\n\r\n    container.append(html);\r\n\r\n    // Cache elements\r\n    self.ctx.imageEl = $('#myio-img', container);\r\n    self.ctx.statusEl = $('#myio-status', container);\r\n};\r\n\r\nself.onDataUpdated = function () {\r\n    try {\r\n        const s = self.ctx.settings || {};\r\n        const data = self.ctx.data?.[0]?.data;\r\n        const value = data && data.length > 0 ? data[data.length - 1][1] : null;\r\n\r\n        const onImg = s.onImageUrl || 'https://www.tech2w.com/myio/ar-on-model.png';\r\n        const offImg = s.offImageUrl || 'https://www.tech2w.com/myio/ar-off-model.png';\r\n        const threshold = s.threshold || 100;\r\n\r\n        if (value == null) {\r\n            self.ctx.imageEl.attr('src', offImg).css('opacity', 0.3);\r\n            self.ctx.statusEl.text('Sem dado').css('color', '#999');\r\n        } else if (value > threshold) {\r\n            self.ctx.imageEl.attr('src', onImg).css('opacity', 1);\r\n            self.ctx.statusEl.text('Status: ON').css('color', 'green');\r\n        } else {\r\n            self.ctx.imageEl.attr('src', offImg).css('opacity', 1);\r\n            self.ctx.statusEl.text('Status: OFF').css('color', 'red');\r\n        }\r\n    } catch (e) {\r\n        console.error(\"Erro em onDataUpdated:\", e);\r\n    }\r\n};\r\n\r\nself.onResize = function () {\r\n    const w = self.ctx.width;\r\n    const h = self.ctx.height;\r\n\r\n    const imgSize = Math.min(w, h) * 0.5;\r\n    $('#myio-img', self.ctx.$container).css('width', imgSize + 'px');\r\n};\r\n\r\nself.onDestroy = function () {};\r\n",
      "settingsSchema" : "{}",
      "dataKeySettingsSchema" : "{}\n",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Attributes card\",\"decimals\":null}"
    },
    "externalId" : null,
    "resources" : null,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "77ed6d80-4160-11f0-bdaa-1bbe0793dcff"
    },
    "scada" : false,
    "tags" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}